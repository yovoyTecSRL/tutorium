<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>üß† Mi Profe de Ingl√©s IA - Conversaci√≥n en Tiempo Real</title>
  <meta name="description" content="Tu tutor personalizado de ingl√©s con IA. Conversaci√≥n en tiempo real con correcci√≥n instant√°nea y an√°lisis de pronunciaci√≥n.">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Source+Sans+Pro:wght@300;400;600;700&display=swap');
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Source Sans Pro', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #2d3748;
      min-height: 100vh;
      position: relative;
      overflow-x: hidden;
    }
    
    .english-bg {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      background: 
        radial-gradient(circle at 20% 30%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 70%, rgba(102, 126, 234, 0.1) 0%, transparent 50%);
      animation: englishPulse 8s ease-in-out infinite;
    }
    
    @keyframes englishPulse {
      0%, 100% { opacity: 0.7; }
      50% { opacity: 1; }
    }
    
    .container {
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      padding: 20px;
      position: relative;
      z-index: 1;
    }
    
    .header-section {
      background: linear-gradient(145deg, #ffffff 0%, #f7fafc 100%);
      border-radius: 20px;
      padding: 30px;
      margin-bottom: 20px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
      text-align: center;
      border: 3px solid #4299e1;
      max-width: 800px;
      width: 100%;
    }
    
    .main-title {
      font-family: 'Playfair Display', serif;
      font-size: 2.8rem;
      font-weight: 700;
      color: #2b6cb0;
      margin-bottom: 10px;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
    }
    
    .subtitle {
      font-size: 1.2rem;
      color: #4a5568;
      margin-bottom: 20px;
      line-height: 1.5;
    }
    
    .teacher-avatar {
      width: 160px;
      height: 160px;
      border-radius: 50%;
      border: 4px solid #4299e1;
      box-shadow: 0 10px 25px rgba(66, 153, 225, 0.3);
      margin: 20px 0;
      transition: all 0.3s ease;
      object-fit: cover;
    }
    
    .teacher-avatar.listening {
      border-color: #e53e3e;
      box-shadow: 0 10px 25px rgba(229, 62, 62, 0.5);
      animation: listeningPulse 1s ease-in-out infinite;
    }
    
    @keyframes listeningPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    
    .conversation-controls {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-bottom: 25px;
      flex-wrap: wrap;
    }
    
    .control-button {
      background: linear-gradient(145deg, #4299e1 0%, #3182ce 100%);
      border: none;
      color: white;
      padding: 15px 25px;
      font-size: 14px;
      font-family: 'Source Sans Pro', sans-serif;
      font-weight: 600;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 5px 15px rgba(66, 153, 225, 0.3);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      min-width: 120px;
    }
    
    .control-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(66, 153, 225, 0.4);
    }
    
    .mic-button {
      background: linear-gradient(145deg, #e53e3e 0%, #c53030 100%);
      box-shadow: 0 5px 15px rgba(229, 62, 62, 0.3);
    }
    
    .mic-button:hover {
      box-shadow: 0 8px 20px rgba(229, 62, 62, 0.4);
    }
    
    .mic-button.recording {
      animation: recordingPulse 1s ease-in-out infinite;
    }
    
    @keyframes recordingPulse {
      0%, 100% { background: linear-gradient(145deg, #e53e3e 0%, #c53030 100%); }
      50% { background: linear-gradient(145deg, #fc8181 0%, #f56565 100%); }
    }
    
    .conversation-display {
      background: #f7fafc;
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      padding: 25px;
      min-height: 300px;
      max-height: 500px;
      overflow-y: auto;
      margin-bottom: 20px;
      width: 100%;
      max-width: 800px;
    }
    
    .message {
      margin-bottom: 15px;
      padding: 15px 20px;
      border-radius: 12px;
      animation: messageSlide 0.3s ease-out;
    }
    
    @keyframes messageSlide {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .user-message {
      background: linear-gradient(145deg, #bee3f8, #90cdf4);
      color: #1a365d;
      margin-left: 30px;
      border-bottom-right-radius: 4px;
    }
    
    .teacher-message {
      background: linear-gradient(145deg, #c6f6d5, #9ae6b4);
      color: #22543d;
      margin-right: 30px;
      border-bottom-left-radius: 4px;
    }
    
    .status-bar {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 12px 20px;
      border-radius: 25px;
      font-size: 14px;
      font-weight: 600;
      background: rgba(255, 255, 255, 0.95);
      border: 2px solid #4299e1;
      color: #2b6cb0;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      backdrop-filter: blur(10px);
      z-index: 1000;
    }
    
    @media (max-width: 768px) {
      .main-title { font-size: 2.2rem; }
      .conversation-controls { flex-direction: column; align-items: center; }
      .control-button { width: 200px; }
    }
  </style>
</head>
<body>
  <div class="english-bg"></div>
  <div class="status-bar" id="status">üü¢ Sistema Activo</div>
  
  <div class="container">
    <div class="header-section">
      <h1 class="main-title">üß† Mi Profe de Ingl√©s IA</h1>
      <p class="subtitle">Conversaci√≥n en tiempo real con correcci√≥n instant√°nea y an√°lisis avanzado de pronunciaci√≥n</p>
      <img class="teacher-avatar" id="teacherAvatar" src="https://images.unsplash.com/photo-1589578527966-198d5f41c179?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&q=80" alt="English Teacher">
    </div>

    <div class="conversation-controls">
      <button onclick="startConversation()" class="control-button" id="startButton">üöÄ Iniciar</button>
      <button onclick="toggleMicrophone()" class="control-button mic-button" id="micButton">üé§ Hablar</button>
      <button onclick="switchLanguage()" class="control-button" id="langButton">üåê Idioma</button>
      <button onclick="clearConversation()" class="control-button">üóëÔ∏è Limpiar</button>
    </div>

    <div class="conversation-display" id="conversationDisplay">
      <div class="teacher-message">
        üëã Hello! I'm your AI English teacher. Let's start practicing! Try saying something in English and I'll help you improve your pronunciation, grammar, and vocabulary. Ready to begin?
      </div>
    </div>
  </div>

  <script>
    let isListening = false;
    let isConversationActive = false;
    let currentLanguage = 'en-US';
    let recognition;
    let audioContext;

    function initAudio() {
      try {
        audioContext = new (window.AudioContext || window.webkitAudioContext)();
      } catch (e) {
        console.warn('Audio context not supported');
      }
    }

    function playSound(frequency, duration, type = 'sine') {
      if (!audioContext) return;
      
      const oscillator = audioContext.createOscillator();
      const gainNode = audioContext.createGain();
      
      oscillator.connect(gainNode);
      gainNode.connect(audioContext.destination);
      
      oscillator.frequency.value = frequency;
      oscillator.type = type;
      
      gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
      gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
      
      oscillator.start(audioContext.currentTime);
      oscillator.stop(audioContext.currentTime + duration);
    }

    function initSpeechRecognition() {
      if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
        recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
        recognition.lang = currentLanguage;
        recognition.continuous = false;
        recognition.interimResults = false;
        
        recognition.onstart = function() {
          updateStatus('üé§ Listening...');
          document.getElementById('teacherAvatar').classList.add('listening');
          playSound(600, 0.3);
        };
        
        recognition.onresult = function(event) {
          const transcript = event.results[0][0].transcript;
          const confidence = event.results[0][0].confidence;
          
          addMessage(transcript, 'user');
          analyzeUserInput(transcript, confidence);
          
          updateStatus('‚úÖ Analizando...');
          playSound(800, 0.4, 'triangle');
        };
        
        recognition.onerror = function(event) {
          updateStatus('‚ùå Error de micr√≥fono');
          document.getElementById('teacherAvatar').classList.remove('listening');
          playSound(300, 0.6, 'sawtooth');
        };
        
        recognition.onend = function() {
          isListening = false;
          document.getElementById('micButton').classList.remove('recording');
          document.getElementById('teacherAvatar').classList.remove('listening');
          document.getElementById('micButton').innerHTML = 'üé§ Hablar';
          
          updateStatus(isConversationActive ? 'üü¢ Conversaci√≥n Activa' : 'üü¢ Sistema Activo');
        };
      }
    }

    function startConversation() {
      isConversationActive = true;
      document.getElementById('startButton').innerHTML = '‚èπÔ∏è Parar';
      document.getElementById('startButton').onclick = stopConversation;
      updateStatus('üü¢ Conversaci√≥n Activa');
      
      const greeting = "Perfect! Let's practice English together. You can ask me anything about grammar, vocabulary, or just have a casual conversation. What would you like to talk about?";
      
      addMessage(greeting, 'teacher');
      speakMessage(greeting);
    }

    function stopConversation() {
      isConversationActive = false;
      document.getElementById('startButton').innerHTML = 'üöÄ Iniciar';
      document.getElementById('startButton').onclick = startConversation;
      updateStatus('üü¢ Sistema Activo');
      
      if (isListening) {
        recognition.stop();
      }
    }

    function toggleMicrophone() {
      if (!recognition) {
        initSpeechRecognition();
      }
      
      if (!isListening) {
        recognition.start();
        isListening = true;
        document.getElementById('micButton').classList.add('recording');
        document.getElementById('micButton').innerHTML = 'üõë Parar';
      } else {
        recognition.stop();
        isListening = false;
        document.getElementById('micButton').classList.remove('recording');
        document.getElementById('micButton').innerHTML = 'üé§ Hablar';
      }
    }

    function switchLanguage() {
      currentLanguage = currentLanguage === 'en-US' ? 'es-ES' : 'en-US';
      
      if (recognition) {
        recognition.lang = currentLanguage;
      }
      
      updateStatus(`üåê Idioma: ${currentLanguage === 'en-US' ? 'English' : 'Espa√±ol'}`);
    }

    function addMessage(text, type) {
      const container = document.getElementById('conversationDisplay');
      const messageDiv = document.createElement('div');
      messageDiv.className = `message ${type}-message`;
      messageDiv.textContent = text;
      container.appendChild(messageDiv);
      container.scrollTop = container.scrollHeight;
    }

    async function analyzeUserInput(text, confidence) {
      try {
        const response = await fetch("https://api.openai.com/v1/chat/completions", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": "Bearer YOUR_OPENAI_API_KEY_HERE"
          },
          body: JSON.stringify({
            model: "gpt-3.5-turbo",
            messages: [
              {
                role: "system",
                content: "You are an expert English teacher specializing in real-time conversation practice. Analyze the student's English for grammar errors, pronunciation issues, and provide immediate constructive feedback. If there are errors, first correct them, then respond naturally to continue the conversation. Be encouraging and educational."
              },
              {
                role: "user",
                content: `Analyze this English text (confidence: ${confidence}): "${text}"`
              }
            ]
          })
        });

        const data = await response.json();
        const feedback = data.choices[0].message.content;
        
        addMessage(feedback, 'teacher');
        speakMessage(feedback);

      } catch (error) {
        console.error("Error analyzing input:", error);
        const errorMsg = "Sorry, I had trouble analyzing your input. Could you please try again?";
        addMessage(errorMsg, 'teacher');
        speakMessage(errorMsg);
      }
    }

    function clearConversation() {
      document.getElementById('conversationDisplay').innerHTML = `
        <div class="teacher-message">
          üëã Hello! I'm your AI English teacher. Let's start practicing! Try saying something in English and I'll help you improve your pronunciation, grammar, and vocabulary. Ready to begin?
        </div>
      `;
    }

    function speakMessage(text) {
      if ('speechSynthesis' in window) {
        speechSynthesis.cancel();
        
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = currentLanguage;
        utterance.rate = 0.85;
        utterance.pitch = 1;
        utterance.volume = 0.8;
        
        const voices = speechSynthesis.getVoices();
        const preferredVoice = voices.find(voice => 
          voice.lang.includes(currentLanguage.split('-')[0])
        ) || voices[0];
        
        if (preferredVoice) {
          utterance.voice = preferredVoice;
        }
        
        speechSynthesis.speak(utterance);
      }
    }

    function updateStatus(message) {
      document.getElementById('status').textContent = message;
    }

    document.addEventListener('DOMContentLoaded', function() {
      initAudio();
      initSpeechRecognition();
    });

    if ('speechSynthesis' in window) {
      speechSynthesis.onvoiceschanged = function() {
        console.log('Voices loaded');
      };
    }
  </script>
</body>





</html>